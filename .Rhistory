theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
#scale_color_manual(values = c("WT" = "#00CC00", "caa39" = "#339900", "h1.3" = "#FFCC00", "caa39 h1.3" = "#FF9900",
#                               "WT_NS" = "#66CCFF", "caa39_NS" = "#3399FF", "h1.3_NS" = "#FF99CC", "caa39 h1.3_NS" = "#FF6699")) +
facet_grid(Group ~ traitement, drop = TRUE, scales = "free_x")
factor(germination_perimeter_summary$Group, levels = order)
droplevels(germination_perimeter_summary$Group)
# Plot the evolution of seed perimeter
ggplot(germination_perimeter_summary, aes(x = Slice, y = Mean_Perimeter, group = Group)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = Mean_Perimeter - SD_Perimeter, ymax = Mean_Perimeter + SD_Perimeter, fill = Group), alpha = 0.3, linetype = 0) +
labs(title = "Evolution of Seed Perimeter Over Time", x = "Time (slices)", y = "Mean Perimeter (pixels)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
#scale_color_manual(values = c("WT" = "#00CC00", "caa39" = "#339900", "h1.3" = "#FFCC00", "caa39 h1.3" = "#FF9900",
#                               "WT_NS" = "#66CCFF", "caa39_NS" = "#3399FF", "h1.3_NS" = "#FF99CC", "caa39 h1.3_NS" = "#FF6699")) +
facet_grid(Group ~ traitement, drop = TRUE, scales = "free")
# Plot the evolution of seed perimeter
ggplot(germination_perimeter_summary, aes(x = Slice, y = Mean_Perimeter, group = Group)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = Mean_Perimeter - SD_Perimeter, ymax = Mean_Perimeter + SD_Perimeter, fill = Group), alpha = 0.3, linetype = 0) +
labs(title = "Evolution of Seed Perimeter Over Time", x = "Time (slices)", y = "Mean Perimeter (pixels)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
#scale_color_manual(values = c("WT" = "#00CC00", "caa39" = "#339900", "h1.3" = "#FFCC00", "caa39 h1.3" = "#FF9900",
#                               "WT_NS" = "#66CCFF", "caa39_NS" = "#3399FF", "h1.3_NS" = "#FF99CC", "caa39 h1.3_NS" = "#FF6699")) +
facet_grid(Group ~ traitement, drop = TRUE, scales = "free_y")
# Plot the evolution of seed perimeter
ggplot(germination_perimeter_summary, aes(x = Slice, y = Mean_Perimeter, group = Group)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = Mean_Perimeter - SD_Perimeter, ymax = Mean_Perimeter + SD_Perimeter, fill = Group), alpha = 0.3, linetype = 0) +
labs(title = "Evolution of Seed Perimeter Over Time", x = "Time (slices)", y = "Mean Perimeter (pixels)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
#scale_color_manual(values = c("WT" = "#00CC00", "caa39" = "#339900", "h1.3" = "#FFCC00", "caa39 h1.3" = "#FF9900",
#                               "WT_NS" = "#66CCFF", "caa39_NS" = "#3399FF", "h1.3_NS" = "#FF99CC", "caa39 h1.3_NS" = "#FF6699")) +
facet_grid(Group , drop = TRUE, scales = "free_y")
# Plot the evolution of seed perimeter
ggplot(germination_perimeter_summary, aes(x = Slice, y = Mean_Perimeter, group = Group)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = Mean_Perimeter - SD_Perimeter, ymax = Mean_Perimeter + SD_Perimeter, fill = Group), alpha = 0.3, linetype = 0) +
labs(title = "Evolution of Seed Perimeter Over Time", x = "Time (slices)", y = "Mean Perimeter (pixels)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
#scale_color_manual(values = c("WT" = "#00CC00", "caa39" = "#339900", "h1.3" = "#FFCC00", "caa39 h1.3" = "#FF9900",
#                               "WT_NS" = "#66CCFF", "caa39_NS" = "#3399FF", "h1.3_NS" = "#FF99CC", "caa39 h1.3_NS" = "#FF6699")) +
facet_grid(cols = Group , drop = TRUE, scales = "free_y")
# Céer un data frame avec la taille moyenne des graines de chaque lignées à chaque temps
germination_perimeter_summary <- germination_postQC_df %>%
group_by(Group, traitement, Slice) %>%
summarise(
Mean_Perimeter = mean(Perim., na.rm = TRUE),
SD_Perimeter = sd(Perim., na.rm = TRUE)
) %>%
ungroup()
# Définir l’ordre voulu pour Group ET retirer les niveaux vides
order <- c("WT", "caa39", "h1.3", "caa39 h1.3",
"WT_NS", "caa39_NS", "h1.3_NS", "caa39 h1.3_NS")
germination_perimeter_summary$Group <- factor(germination_perimeter_summary$Group, levels = order)
germination_perimeter_summary$Group <- droplevels(germination_perimeter_summary$Group)
# Plot the evolution of seed perimeter
ggplot(germination_perimeter_summary, aes(x = Slice, y = Mean_Perimeter, group = Group)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = Mean_Perimeter - SD_Perimeter, ymax = Mean_Perimeter + SD_Perimeter, fill = Group), alpha = 0.3, linetype = 0) +
labs(title = "Evolution of Seed Perimeter Over Time", x = "Time (slices)", y = "Mean Perimeter (pixels)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
#scale_color_manual(values = c("WT" = "#00CC00", "caa39" = "#339900", "h1.3" = "#FFCC00", "caa39 h1.3" = "#FF9900",
#                               "WT_NS" = "#66CCFF", "caa39_NS" = "#3399FF", "h1.3_NS" = "#FF99CC", "caa39 h1.3_NS" = "#FF6699")) +
facet_grid(cols = Group , drop = TRUE, scales = "free_y")
# Plot the evolution of seed perimeter
ggplot(germination_perimeter_summary, aes(x = Slice, y = Mean_Perimeter, group = Group)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = Mean_Perimeter - SD_Perimeter, ymax = Mean_Perimeter + SD_Perimeter, fill = Group), alpha = 0.3, linetype = 0) +
labs(title = "Evolution of Seed Perimeter Over Time", x = "Time (slices)", y = "Mean Perimeter (pixels)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
#scale_color_manual(values = c("WT" = "#00CC00", "caa39" = "#339900", "h1.3" = "#FFCC00", "caa39 h1.3" = "#FF9900",
#                               "WT_NS" = "#66CCFF", "caa39_NS" = "#3399FF", "h1.3_NS" = "#FF99CC", "caa39 h1.3_NS" = "#FF6699")) +
facet_grid(.~ Group , drop = TRUE, scales = "free_y")
# Set working directory
setwd("~/onedrive_amu/bio-informatique/test_spiro/2025.07.21 spiro/Results/Germination/Analysis output/standard_analysis")
# Load data
descriptive_df <- read.table("descriptive_stats.tsv", header = TRUE, sep = "\t")
# add new col for traitement
descriptive_df$traitement <- ifelse(grepl("_NS$", descriptive_df$Group),
"Non stratifiées", "Stratifiées")
# Convert data frame to long
descriptive_long <- descriptive_df %>%
pivot_longer(cols = c("Germinated.seeds", "Ungerminated.seeds"),
names_to = "Seed",
values_to = "Count")
descriptive_long$Seed <- factor(descriptive_long$Seed,
levels = c("Germinated.seeds", "Ungerminated.seeds"),
labels = c("Germinated", "Non-Germinated"))
# Définir l’ordre voulu pour Group ET retirer les niveaux vides
order <- c("WT", "caa39", "h1.3", "caa39 h1.3",
"WT_NS", "caa39_NS", "h1.3_NS", "caa39 h1.3_NS")
descriptive_long$Group <- factor(descriptive_long$Group, levels = order)
descriptive_long$Group <- droplevels(descriptive_long$Group)
# plot number of germinated seed/non germinated seed
ggplot(descriptive_long, aes(x = Group, y = Count, fill = Seed)) +
geom_bar(stat = "identity") +
labs(title = "Number of Germinated vs Non-Germinated Seeds", x = "Lines", y = "Count") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_fill_manual(values = c("Germinated" = "#00CC00", "Non-Germinated" = "#339900"))+
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
# Plot mean germination time
ggplot(descriptive_df, aes(x = Group, y = Mean.Germination.Time..h., fill = traitement)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin = Mean.Germination.Time..h. - Mean.Germination.Time.SE,
ymax = Mean.Germination.Time..h. + Mean.Germination.Time.SE),
width = 0.2) +
labs(title = "Germination Time by Line", x = "Lines", y = "Germination Time (days)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
View(descriptive_long)
descriptive_long$traitement <- factor(descriptive_long$traitement,
levels = c("Stratifiées", "Non stratifiées"),
labels = c("Stratifiées", "Non stratifiées"))
# Plot mean germination time
ggplot(descriptive_df, aes(x = Group, y = Mean.Germination.Time..h., fill = traitement)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin = Mean.Germination.Time..h. - Mean.Germination.Time.SE,
ymax = Mean.Germination.Time..h. + Mean.Germination.Time.SE),
width = 0.2) +
labs(title = "Germination Time by Line", x = "Lines", y = "Germination Time (days)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
levels(descriptive_long$Group)
View(descriptive_df)
# Définir l’ordre voulu pour Group ET retirer les niveaux vides
descriptive_df$Group <- factor(descriptive_long$df, levels = order)
descriptive_df$Group <- droplevels(descriptive_df$Group)
# Définir l’ordre voulu pour Group ET retirer les niveaux vides
descriptive_df$Group <- factor(descriptive_df$Group, levels = order)
descriptive_df$Group <- droplevels(descriptive_df$Group)
# Plot mean germination time
ggplot(descriptive_df, aes(x = Group, y = Mean.Germination.Time..h., fill = traitement)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin = Mean.Germination.Time..h. - Mean.Germination.Time.SE,
ymax = Mean.Germination.Time..h. + Mean.Germination.Time.SE),
width = 0.2) +
labs(title = "Germination Time by Line", x = "Lines", y = "Germination Time (days)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
#Plot mean seed size (initiale)
ggplot(descriptive_df, aes(x = Group, y = Seed.Size..cm2., fill = traitement)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin = Seed.Size..cm2. - Seed.Size.SD,
ymax = Seed.Size..cm2. + Seed.Size.SD),
width = 0.2) +
labs(title = "Seed Size by Line", x = "Lines", y = "Seed Size (cm2)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
# 2. germination per seed
# Load the germination data
germination_df <- read.table("germination-perseed.tsv", header = TRUE, sep = "\t")
# add new col for traitement
germination_df$traitement <- ifelse(
is.na(germination_df$Group) | germination_df$Group == "",
NA,  # Ou "" si tu préfères une chaîne vide
ifelse(grepl("_NS$", germination_df$Group), "Non stratifiées", "Stratifiées")
)
# Count number of germinated, non germinated et non retenues
# Renomme les colonnes si besoin pour simplifier (optionnel, mais conseillé pour la lisibilité)
germination_df <- germination_df %>%
rename(
Germination_Time = Germination.Time..h.,
Seed_Size = Seed.Size..cm2.
)
# Comptage par lignée
germination_summary <- germination_df %>%
group_by(Group) %>%
summarise(
Germinated = sum(!is.na(Germination_Time) & !is.na(traitement)),
Not_germinated = sum(is.na(Germination_Time) & !is.na(traitement)),
Eliminated = sum(is.na(traitement))
)
# plot germination time
ggplot(germination_df %>% filter(!is.na(traitement)), aes(x = Group, y = Germination_Time, fill = traitement)) +
geom_boxplot(na.rm = TRUE) +
geom_jitter(shape= 1, width = 0.2, size = 1.5, alpha = 0.7, na.rm = TRUE) +
labs(title = "Germination Time by Line", x = "Lines", y = "Germination Time (hours)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x", )
# Définir l’ordre voulu pour Group ET retirer les niveaux vides
germination_df$Group <- factor(germination_df$Group, levels = order)
germination_df$Group <- droplevels(germination_df$Group)
# plot germination time
ggplot(germination_df %>% filter(!is.na(traitement)), aes(x = Group, y = Germination_Time, fill = traitement)) +
geom_boxplot(na.rm = TRUE) +
geom_jitter(shape= 1, width = 0.2, size = 1.5, alpha = 0.7, na.rm = TRUE) +
labs(title = "Germination Time by Line", x = "Lines", y = "Germination Time (hours)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x", )
# Plot seed size at germination time
ggplot(germination_df %>% filter(!is.na(traitement)), aes(x = Group, y = Seed_Size, fill = traitement)) +
geom_boxplot(na.rm = TRUE) +
geom_jitter(shape= 1, width = 0.2, size = 1.5, alpha = 0.7, na.rm = TRUE) +
labs(title = "Seed Size by Line", x = "Lines", y = "Seed Size (cm2)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
# changer le répertoire de travail
setwd("~/onedrive_amu/bio-informatique/test_spiro/2025.07.21 spiro/Results/Germination")
# Load the seed perimeter data
germination_postQC_df <- read.table("germination.postQC.tsv", header = TRUE, sep = "\t")
# add new col for traitement
germination_postQC_df$traitement <- ifelse(
grepl("_NS$", germination_postQC_df$Group),
"Non stratifiées", "Stratifiées"
)
# Céer un data frame avec la taille moyenne des graines de chaque lignées à chaque temps
germination_perimeter_summary <- germination_postQC_df %>%
group_by(Group, traitement, Slice) %>%
summarise(
Mean_Perimeter = mean(Perim., na.rm = TRUE),
SD_Perimeter = sd(Perim., na.rm = TRUE)
) %>%
ungroup()
# Définir l’ordre voulu pour Group ET retirer les niveaux vides
order <- c("WT", "caa39", "h1.3", "caa39 h1.3",
"WT_NS", "caa39_NS", "h1.3_NS", "caa39 h1.3_NS")
germination_perimeter_summary$Group <- factor(germination_perimeter_summary$Group, levels = order)
germination_perimeter_summary$Group <- droplevels(germination_perimeter_summary$Group)
# Plot the evolution of seed perimeter
ggplot(germination_perimeter_summary, aes(x = Slice, y = Mean_Perimeter, group = Group)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = Mean_Perimeter - SD_Perimeter, ymax = Mean_Perimeter + SD_Perimeter, fill = Group), alpha = 0.3, linetype = 0) +
labs(title = "Evolution of Seed Perimeter Over Time", x = "Time (slices)", y = "Mean Perimeter (pixels)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
facet_grid(.~ Group , drop = TRUE, scales = "free_y")
View(germination_df)
# Rename column
germination_df <- germination_df %>%
rename(Germination.Detected.on.Frame = Slice)
# Rename column
germination_df <- germination_df %>%
rename(Slice = Germination.Detected.on.Frame )
# Plot germination SLICE
ggplot(germination_df %>% filter(!is.na(traitement)), aes(x = Group, y = Slice, fill = traitement)) +
geom_boxplot(na.rm = TRUE) +
geom_jitter(shape= 1, width = 0.2, size = 1.5, alpha = 0.7, na.rm = TRUE) +
labs(title = "Germination Slice by Line", x = "Lines", y = "Germination Slice") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
# moyenne sous forme d'un entier de la colonne Slice par group et traitement
germ_slice <- germination_df %>%
group_by(Group, traitement) %>%
summarise(
Mean_Slice = mean(Slice, na.rm = TRUE),
SD_Slice = sd(Slice, na.rm = TRUE)
) %>%
ungroup()
View(germ_slice)
# moyenne sous forme d'un entier de la colonne Slice par group et traitement
germ_slice <- germination_df %>%
group_by(Group, traitement) %>%
summarise(
Mean_Slice = median(Slice, na.rm = TRUE),
SD_Slice = sd(Slice, na.rm = TRUE)
) %>%
ungroup()
# plot germination slice
ggplot(germ_slice %>% filter(!is.na(traitement)), aes(x = Group, y = Median_Slice, fill = traitement)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin = Median_Slice - SD_Slice, ymax = Median_Slice + SD_Slice), width = 0.2) +
labs(title = "Germination Slice by Line", x = "Lines", y = "Median Germination Slice") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
# moyenne sous forme d'un entier de la colonne Slice par group et traitement
germ_slice <- germination_df %>%
group_by(Group, traitement) %>%
summarise(
Median_Slice = median(Slice, na.rm = TRUE),
SD_Slice = sd(Slice, na.rm = TRUE)
) %>%
ungroup()
# plot germination slice
ggplot(germ_slice %>% filter(!is.na(traitement)), aes(x = Group, y = Median_Slice, fill = traitement)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin = Median_Slice - SD_Slice, ymax = Median_Slice + SD_Slice), width = 0.2) +
labs(title = "Germination Slice by Line", x = "Lines", y = "Median Germination Slice") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
# Set working directory
setwd("~/onedrive_amu/bio-informatique/test_spiro/2025.07.21 spiro/Results/Germination/Analysis output/low_stringency_analysis")
# Load data
descriptive_df <- read.table("descriptive_stats.tsv", header = TRUE, sep = "\t")
View(descriptive_df)
# add new col for traitement
descriptive_df$traitement <- ifelse(grepl("_NS$", descriptive_df$Group),
"Non stratifiées", "Stratifiées")
# Convert data frame to long
descriptive_long <- descriptive_df %>%
pivot_longer(cols = c("Germinated.seeds", "Ungerminated.seeds"),
names_to = "Seed",
values_to = "Count")
descriptive_long$Seed <- factor(descriptive_long$Seed,
levels = c("Germinated.seeds", "Ungerminated.seeds"),
labels = c("Germinated", "Non-Germinated"))
descriptive_long$traitement <- factor(descriptive_long$traitement,
levels = c("Stratifiées", "Non stratifiées"),
labels = c("Stratifiées", "Non stratifiées"))
# Définir l’ordre voulu pour Group ET retirer les niveaux vides
order <- c("WT", "caa39", "h1.3", "caa39 h1.3",
"WT_NS", "caa39_NS", "h1.3_NS", "caa39 h1.3_NS")
descriptive_long$Group <- factor(descriptive_long$Group, levels = order)
descriptive_long$Group <- droplevels(descriptive_long$Group)
# plot number of germinated seed/non germinated seed
ggplot(descriptive_long, aes(x = Group, y = Count, fill = Seed)) +
geom_bar(stat = "identity") +
labs(title = "Number of Germinated vs Non-Germinated Seeds", x = "Lines", y = "Count") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_fill_manual(values = c("Germinated" = "#00CC00", "Non-Germinated" = "#339900"))+
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
# Définir l’ordre voulu pour Group ET retirer les niveaux vides
descriptive_df$Group <- factor(descriptive_df$Group, levels = order)
descriptive_df$Group <- droplevels(descriptive_df$Group)
# Plot mean germination time
ggplot(descriptive_df, aes(x = Group, y = Mean.Germination.Time..h., fill = traitement)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin = Mean.Germination.Time..h. - Mean.Germination.Time.SE,
ymax = Mean.Germination.Time..h. + Mean.Germination.Time.SE),
width = 0.2) +
labs(title = "Germination Time by Line", x = "Lines", y = "Germination Time (days)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
#Plot mean seed size (initiale)
ggplot(descriptive_df, aes(x = Group, y = Seed.Size..cm2., fill = traitement)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin = Seed.Size..cm2. - Seed.Size.SD,
ymax = Seed.Size..cm2. + Seed.Size.SD),
width = 0.2) +
labs(title = "Seed Size by Line", x = "Lines", y = "Seed Size (cm2)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
# 2. germination per seed
# Load the germination data
germination_df <- read.table("germination-perseed.tsv", header = TRUE, sep = "\t")
# add new col for traitement
germination_df$traitement <- ifelse(
is.na(germination_df$Group) | germination_df$Group == "",
NA,  # Ou "" si tu préfères une chaîne vide
ifelse(grepl("_NS$", germination_df$Group), "Non stratifiées", "Stratifiées")
)
# Count number of germinated, non germinated et non retenues
# Renomme les colonnes si besoin pour simplifier (optionnel, mais conseillé pour la lisibilité)
germination_df <- germination_df %>%
rename(
Germination_Time = Germination.Time..h.,
Seed_Size = Seed.Size..cm2.
)
# Comptage par lignée
germination_summary <- germination_df %>%
group_by(Group) %>%
summarise(
Germinated = sum(!is.na(Germination_Time) & !is.na(traitement)),
Not_germinated = sum(is.na(Germination_Time) & !is.na(traitement)),
Eliminated = sum(is.na(traitement))
)
# Définir l’ordre voulu pour Group ET retirer les niveaux vides
germination_df$Group <- factor(germination_df$Group, levels = order)
germination_df$Group <- droplevels(germination_df$Group)
# Rename column
germination_df <- germination_df %>%
rename(Slice = Germination.Detected.on.Frame )
# moyenne sous forme d'un entier de la colonne Slice par group et traitement
germ_slice <- germination_df %>%
group_by(Group, traitement) %>%
summarise(
Median_Slice = median(Slice, na.rm = TRUE),
SD_Slice = sd(Slice, na.rm = TRUE)
) %>%
ungroup()
# plot germination slice
ggplot(germ_slice %>% filter(!is.na(traitement)), aes(x = Group, y = Median_Slice, fill = traitement)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin = Median_Slice - SD_Slice, ymax = Median_Slice + SD_Slice), width = 0.2) +
labs(title = "Germination Slice by Line", x = "Lines", y = "Median Germination Slice") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
View(germ_slice)
# plot germination time
ggplot(germination_df %>% filter(!is.na(traitement)), aes(x = Group, y = Germination_Time, fill = traitement)) +
geom_boxplot(na.rm = TRUE) +
geom_jitter(shape= 1, width = 0.2, size = 1.5, alpha = 0.7, na.rm = TRUE) +
labs(title = "Germination Time by Line", x = "Lines", y = "Germination Time (hours)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x", )
# Plot seed size at germination time
ggplot(germination_df %>% filter(!is.na(traitement)), aes(x = Group, y = Seed_Size, fill = traitement)) +
geom_boxplot(na.rm = TRUE) +
geom_jitter(shape= 1, width = 0.2, size = 1.5, alpha = 0.7, na.rm = TRUE) +
labs(title = "Seed Size by Line", x = "Lines", y = "Seed Size (cm2)") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(legend.position = "none") +
scale_fill_manual(values = c("Stratifiées" = "#FFFFCC", "Non stratifiées" = "#CCFF99")) +
facet_wrap(~traitement, drop = TRUE, scales = "free_x")
shiny::runApp('~/Documents/github-repositories/shiny_fluorcam')
runApp('~/Documents/github-repositories/shiny_fluorcam')
# Run this in RStudio console to check for missing objects/functions
# Check if files exist
file.exists(c("global.R", "helpers.R", "ui.R", "server.R"))
# Source files individually to see where the error occurs
source("global.R")
runApp('~/Documents/github-repositories/shiny_fluorcam')
source("global.R")
runApp('~/Documents/github-repositories/shiny_fluorcam')
setwd("~/Documents/github-repositories/shiny_fluorcam")
file.exists(c("global.R", "helpers.R", "ui.R", "server.R"))
# Source files individually to see where the error occurs
source("global.R")
source("helpers.R")
source("ui.R")
source("server.R")
# Check if key functions exist
exists("analyse_curve")
exists("analyse_barplot")
exists("check_normality")
runApp()
source("global.R")
source("helpers.R")
source("ui.R")
ource("server.R")
source("server.R")
conflicts()
search()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
process_data_files
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
