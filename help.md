# FluorCam Data Analysis Toolbox - User Guide

## Overview

The FluorCam Data Analysis Toolbox is a Shiny application designed to analyze fluorescence data measured with a FluorCam system. This tool allows you to process .TXT files generated by FluorCam software and perform statistical analysis without requiring R programming knowledge.

---

## Getting Started

### File Requirements

Your data files must follow a specific naming pattern:

**Required Format:** `VAR1_VAR2_VAR3.TXT`

**Example:** `Day1_LineA_Plant001.TXT`

Where:
- **VAR1** = First grouping variable (e.g., Day, Treatment, Time)
- **VAR2** = Second grouping variable (e.g., Line, Genotype, Replicate)
- **VAR3** = Individual identifier (e.g., PlantID, SampleID)

### Data Structure

Your .TXT files should contain:
- **Columns for different time points** (e.g., `Fq_L1`, `Fq_L2`, `Fq_D1`, `Fq_D2`)
- **Parameter measurements** at each time point
- **Consistent column names** across all files

---

## Step-by-Step Guide

### 1. File Name Configuration

1. **Define Variables**: Enter what each variable represents in your file names
   - VAR1: e.g., "Day", "Treatment", "Time"
   - VAR2: e.g., "Line", "Genotype", "Replicate" 
   - VAR3: e.g., "PlantID", "SampleID"

2. **Preview**: Check the filename example to ensure it matches your files

### 2. Load Data

1. **Select Directory**: Click "Select Directory" and choose the folder containing your .TXT files
2. **File Pattern**: Enter the file extension (usually `.TXT`)
3. **View Files**: Use "Toggle File List" to see which files will be loaded
4. **Load**: Click "Load Data" to import your files

**Data Table Features:**
- **Horizontal scrolling**: View all columns by scrolling left/right
- **Toggle view**: Switch between preview (5 rows) and full table
- **Interactive filtering**: Use column filters to search specific values
- **Pagination**: Change number of rows displayed using the dropdown

### 3. Analysis Parameters

#### Graph Type Selection

**Bar Plot**: 
- Use for comparing means between groups
- Includes statistical tests (ANOVA, t-tests)
- Shows error bars and significance letters

**Line Chart**: 
- Use for time-course or multi-point data
- Uses qGAM (quantile Generalized Additive Models)
- Shows confidence intervals and trends

#### Variable Configuration

1. **Root Selection**: Choose which variable to use for grouping
2. **Column Selection**: Select which parameters to analyze
3. **Facet Variable**: Choose how to split data into separate panels
4. **Reorder Groups**: Drag and drop to change the order of groups

#### Line Chart Specific Options

1. **Configure Measurement Parameters**: 
   - Click "Set Measurement Parameters" 
   - Enter time values for each measurement point
   - Specify the time unit (seconds, minutes, hours, etc.)

2. **Control Group**: Select which group to use as control for statistical comparisons

#### Color Customization

- **Automatic Colors**: Default color scheme applied
- **Custom Colors**: Click color boxes to choose specific colors for each group

### 4. Export Results

#### Statistical Data Export

- **Format**: .zip file containing multiple .txt files
- **Contents**: 
  - Summary statistics
  - Normality tests (Bar plots only)
  - ANOVA/Kruskal-Wallis results
  - Post-hoc test results
  - qGAM predictions (Line charts only)
  - Analysis parameters

#### Plot Export

- **Formats**: PNG, PDF, SVG, JPEG
- **Units**: Centimeters (default), inches, or millimeters
- **Dimensions**: Customizable width and height
- **Quality**: High resolution (300 DPI for raster formats)

### 5. Processed Data Export
- **Custom Data Export**: Choose specific columns to export processed data
- **Formats**: Tab-separated .tsv file or .csv file or Excel .xlsx file

---

## Analysis Types Explained

### Bar Plot Analysis

**When to use**: Comparing means between different groups or conditions

**Statistical Tests Performed**:
1. **Shapiro-Wilk test**: Tests normality of data
2. **ANOVA** (if normal) or **Kruskal-Wallis** (if non-normal)
3. **Tukey HSD** (if normal) or **Dunn test** (if non-normal) for pairwise comparisons
4. **Compact Letter Display (CLD)**: Shows significance groups with letters

**Output**:
- Bar chart with error bars (standard error)
- Significance letters above bars
- Statistical test results in export files

### Line Chart Analysis

**When to use**: Analyzing trends over time or across multiple measurement points

**Statistical Method**:
- **qGAM (quantile Generalized Additive Models)**: Robust method for analyzing non-linear trends
- **Control group comparisons**: Statistical tests comparing each group to the selected control

**Output**:
- Line plot with confidence intervals
- Smooth curves showing trends
- Statistical comparisons with control group

---

## Data Interpretation

### Bar Plots

- **Error bars**: Show standard error of the mean
- **Letters**: Groups with different letters are significantly different
- **Colors**: Each group has a distinct color

### Line Charts

- **Lines**: Show the fitted trend for each group
- **Shaded areas**: Confidence intervals around the trend
- **Points**: Show median values at each time point

---

## Troubleshooting

### Common Issues

1. **"No files found"**: 
   - Check file naming pattern matches VAR1_VAR2_VAR3.TXT
   - Verify file extension
   - Ensure files are in the selected directory

2. **"Missing columns"**: 
   - Check that all files have the same column structure
   - Verify parameter column names are consistent

3. **Export not working**:
   - Ensure analysis has been run first
   - Check that you have write permissions in the current directory

4. **Plot not displaying**:
   - Try refreshing the browser
   - Check that analysis completed successfully

### Data Requirements

- **Minimum sample size**: At least 3 observations per group
- **Column consistency**: All files must have identical column names
- **Numeric data**: Parameter values must be numeric (not text)

---

## Tips for Best Results

1. **Consistent naming**: Use consistent file naming across all experiments
2. **Clean data**: Remove any special characters or spaces from parameter names
3. **Balanced design**: Try to have similar sample sizes across groups
4. **Control selection**: Choose an appropriate control group for Line Chart analysis
5. **Color choices**: Use contrasting colors for better visualization

---

## Technical Notes

- **Statistical software**: Built using R and Shiny
- **qGAM package**: Used for Line Chart analysis
- **Data format**: Supports wide-format data (time points as columns)
- **Export formats**: Tab-separated text files for maximum compatibility

---

## Contact and Support

For issues or questions about the FluorCam Data Analysis Toolbox, please refer to the documentation or contact the development team at <a href="mailto:cecile.lecampion@univ-amu.fr">cecile.lecampion@univ-amu.fr</a>.

